<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Parking Status</title>
    <style>
        /* Your CSS styles here */
        .parking-slot {
            /* Define your parking slot styles here */
            padding: 10px;
            margin: 5px;
            border: 1px solid #ccc;
        }
        .available {
            background-color: green;
        }
        .full {
            background-color: red;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Parking Status</h1>
    <div id="parking-status">
        <!-- Parking slots will be added here dynamically -->
    </div>
    <button id="send-parking-details-button">Send Parking Details</button>
</div>

<script src="https://cdn.emailjs.com/dist/email.min.js"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        var loggedInUser = getLoggedInUser();
        var parkingStatusElement1, parkingStatusElement2;

        if (loggedInUser === "a05179639@gmail.com") {
            createParkingSlot("Slot 1", "available");
        } else if (loggedInUser === "fghj79911@gmail.com") {
            createParkingSlot("Slot 2", "available");
        } else {
            createParkingSlot("Slot 1", "full");
            createParkingSlot("Slot 2", "full");
        }

        function createParkingSlot(slotText, slotStatus) {
            var parkingSlot = document.createElement("div");
            parkingSlot.className = "parking-slot " + slotStatus;
            parkingSlot.textContent = slotText;
            document.getElementById("parking-status").appendChild(parkingSlot);
        }
    });

    function getLoggedInUser() {
        // Get the URL parameter for "user" using JavaScript
        var urlParams = new URLSearchParams(window.location.search);
        return urlParams.get("user");
    }

    document.getElementById("send-parking-details-button").addEventListener("click", function () {
        var loggedInUser = getLoggedInUser();
        var parkingSlotDetails;

        if (loggedInUser === "a05179639@gmail.com") {
            parkingSlotDetails = "Your parking slot is Slot 1.";
        } else if (loggedInUser === "fghj79911@gmail.com") {
            parkingSlotDetails = "Your parking slot is Slot 2.";
        } else {
            parkingSlotDetails = "Sorry, no parking slot available for your email.";
        }

        sendParkingDetailsEmail(loggedInUser, parkingSlotDetails);
    });

    function sendParkingDetailsEmail(userEmail, details) {
        // Define your EmailJS service and template IDs
        var serviceID = "service_1eo7b17"; // Replace with your EmailJS service ID
        var templateID = "template_ld6t3jg"; // Replace with your EmailJS template ID

        // Define your EmailJS public key
        var publicKey = "5aIq8rL7kps6ydnMB"; // Replace with your EmailJS public key

        // Set the parameters for your email template
        var templateParams = {
            to_email: userEmail,
            parking_details: details // Use the updated parking slot details here
        };

        // Use EmailJS to send an email with the parking details
        emailjs.send(serviceID, templateID, templateParams, publicKey)
            .then(function(response) {
                console.log("Email sent:", response);
            }, function(error) {
                console.error("Email could not be sent:", error);
            });
    }
</script>
</body>
</html>
